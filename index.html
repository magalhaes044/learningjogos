<!DOCTYPE html>
<html>
<head>
    <title>Space Invaders</title>
    <style>
        #game-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto;
            border: 1px solid #000;
        }

        .player {
            position: absolute;
            bottom: 10px;
            left: 175px;
            width: 50px;
            height: 50px;
            background-color: red;
        }

        .bullet {
            position: absolute;
            background-color: yellow;
            width: 5px;
            height: 10px;
        }

        .enemy {
            position: absolute;
            background-color: green;
            width: 40px;
            height: 40px;
        }

        .row {
            display: flex;
            justify-content: space-between;
        }

        #score {
            text-align: center;
            font-size: 24px;
            margin-top: 20px;
        }

        #message {
            text-align: center;
            font-size: 36px;
            margin-top: 50px;
            display: none;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div class="player"></div>
        <div id="bullet"></div>
        <div id="enemies-container"></div>
    </div>
    <div id="score">Score: <span id="score-value">0</span></div>
    <div id="message"></div>

    <script>
        // Game variables
        let player;
        let bullet;
        let enemiesContainer;
        let scoreValue;
        let message;
        let score;
        let gameRunning;

        // Initialize the game
        function initGame() {
            player = document.querySelector(".player");
            bullet = document.getElementById("bullet");
            enemiesContainer = document.getElementById("enemies-container");
            scoreValue = document.getElementById("score-value");
            message = document.getElementById("message");
            score = 0;
            gameRunning = true;

            createEnemies();

            document.addEventListener("keydown", handleKeyDown);
            requestAnimationFrame(update);
        }

        // Create the enemies
        function createEnemies() {
            for (let i = 0; i < 5; i++) {
                const row = document.createElement("div");
                row.className = "row";
                for (let j = 0; j < 10; j++) {
                    const enemy = document.createElement("div");
                    enemy.className = "enemy";
                    row.appendChild(enemy);
                }
                enemiesContainer.appendChild(row);
            }
        }

        // Handle key down events
        function handleKeyDown(event) {
            if (event.keyCode === 32) {
                shoot();
            } else if (event.keyCode === 37) {
                movePlayer(-10);
            } else if (event.keyCode === 39) {
                movePlayer(10);
            }
        }

        // Move the player
        function movePlayer(delta) {
            const currentPosition = parseInt(player.style.left) || 0;
            const newPosition = currentPosition + delta;
            if (newPosition >= 0 && newPosition <= 350) {
                player.style.left = newPosition + "px";
            }
        }

        // Shoot a bullet
        function shoot() {
            if (!bullet.parentElement) {
                const playerPosition = player.getBoundingClientRect();
                bullet.style.left = (playerPosition.left + 22) + "px";
                bullet.style.bottom = "60px";
                bullet.style.display = "block";
                animateBullet();
            }
        }

        // Animate the bullet
        function animateBullet() {
            const bulletPosition = parseInt(bullet.style.bottom) || 0;
            const newBulletPosition = bulletPosition + 10;
            bullet.style.bottom = newBulletPosition + "px";

            if (newBulletPosition < 400 && gameRunning) {
                requestAnimationFrame(animateBullet);
            } else {
                bullet.style.display = "none";
            }

            checkCollision();
        }

        // Check collision between bullet and enemies
        function checkCollision() {
            const bulletRect = bullet.getBoundingClientRect();
            const enemyRects = enemiesContainer.getElementsByClassName("enemy");
            for (let i = 0; i < enemyRects.length; i++) {
                const enemyRect = enemyRects[i].getBoundingClientRect();
                if (
                    bulletRect.left <= enemyRect.right &&
                    bulletRect.right >= enemyRect.left &&
                    bulletRect.top <= enemyRect.bottom &&
                    bulletRect.bottom >= enemyRect.top
                ) {
                    enemiesContainer.removeChild(enemyRects[i]);
                    score++;
                    scoreValue.innerText = score;
                }
            }

            if (enemiesContainer.children.length === 0) {
                gameRunning = false;
                message.innerText = "Parabéns, você venceu!";
                message.style.display = "block";
            }
        }

        // Update the game state
        function update() {
            if (gameRunning) {
                checkGameOver();
                requestAnimationFrame(update);
            }
        }

        // Check if the game is over
        function checkGameOver() {
            const enemyRects = enemiesContainer.getElementsByClassName("enemy");
            for (let i = 0; i < enemyRects.length; i++) {
                const enemyRect = enemyRects[i].getBoundingClientRect();
                if (enemyRect.bottom >= 380) {
                    gameRunning = false;
                    message.innerText = "Game over!";
                    message.style.display = "block";
                }
            }
        }

        // Start the game
        initGame();
    </script>
</body>
</html>